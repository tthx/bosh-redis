#!/bin/bash

ERR=0
STORE_DIR="<%= p('dir') %>";
CONF_DIR="/var/vcap/jobs/redis_sentinel/config";
CONF_FILE_NAME="redis_sentinel.conf";
CONF_FILE="${CONF_DIR}/${CONF_FILE_NAME}";

if [[ -f "${STORE_DIR}/config/${CONF_FILE_NAME}" ]];
then
  if [[ $(cp -f "${STORE_DIR}/config/${CONF_FILE_NAME}" "${CONF_DIR}/.") -ne 0 ]];
  then
    ERR=1;
    echo "ERROR: Unable to copy ${STORE_DIR}/config/${CONF_FILE_NAME} to ${CONF_DIR}/." >&2;
  else
    echo "Redis Sentinel backup file ${STORE_DIR}/config/${CONF_FILE_NAME} restored";
  fi
fi

exit ${ERR};
